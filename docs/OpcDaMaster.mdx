---
id: 204
title: OpcDaMaster
---

import useBaseUrl from "@docusaurus/useBaseUrl";
import Tag from "@site/src/components/Tag.js";
import Highlight from '@site/src/components/Highlight.js';

:::tip `OPCDA驱动注意`

 使用OPCDA插件时，需安装[OPC核心库](https://gitee.com/diego2098/ThingsGateway/attach_files)

:::

:::tip `提示`

可以通过调试页面，导出/导入OPC节点到网关

:::

## 一、说明

OpcDaMaster作为主站，主动采集OPCDA协议的设备

插件支持远程OPCDA，但需要配置DCOM，相关知识请自行查阅资料

通道只支持 Other 类型

## 二、插件属性配置项

<img src={require("@site/static/img/docs/OpcDaMaster1.png").default} />

| 属性           |  说明                    | 备注|
| ---------------| --------------------------| ---|
| IP         | 连接IP              | localhost|
| Opc名称         | OPC名称，可识别ProgID或CLSID             | Kepware.KEPServerEX.V6|
| 服务端时间戳         | 变量更新时间可选择为OpcServerTime             | true|
| 订阅         | 是否采用OPC订阅方式读取变量                | True|
| 心跳间隔(min)         | 每隔设定时间获取一次服务器状态，并尝试重新连接(min)  |10|
| 死区         | OPC死区              | 0|
| 最大组大小         | 每隔设定大小分一个OPCGroup              | 500|
| 订阅推送间隔         | 订阅更新频率或者连读频率 (ms)             | 1000 |
| 离线恢复时间         | 设备检测到离线时，重新读取的间隔时间（秒） ，只适用于非订阅模式             | 30000 |
| 失败重试次数         | 读取失败时，重试n次后判定变量为离线        ，只适用于非订阅模式       | 3 |


## 三、变量地址配置项

- 变量地址即为 OPC ItemID


